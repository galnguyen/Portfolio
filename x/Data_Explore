--Industry_Select
SELECT industry_title, COUNT(sic_code) AS count 
FROM `bigquery-public-data.sec_quarterly_financials.sic_codes` 
WHERE industry_title LIKE '%RENT%'
GROUP BY 1 
ORDER BY 2 DESC;

--Industry_Details
SELECT 
  code.industry_title, 
  code.sic_code, 
  name.company_name, 
FROM `bigquery-public-data.sec_quarterly_financials.sic_codes` AS code
INNER JOIN `bigquery-public-data.sec_quarterly_financials.quick_summary` AS name
ON code.sic_code = name.sic
WHERE code.industry_title LIKE '%RENTAL%'
GROUP BY 1, 2, 3
ORDER BY 1, 3;

--Measure_Select
SELECT 
  measure_tag, 
  tag_label,doc,
  COUNT(DISTINCT(doc)) AS distinct_doc_count
FROM `bigquery-public-data.sec_quarterly_financials.measure_tag` 
WHERE tag_label LIKE '%capitalization%'
GROUP BY 1, 2, 3
ORDER BY 1;

--Draft 1
SELECT 
  fin.company_name, 
  fin.measure_tag, 
  fin.value, 
  fin.submission_number, 
  render.shortname, 
  MAX(fin.date_accepted) AS accepted_date
FROM `bigquery-public-data.sec_quarterly_financials.quick_summary` AS fin
LEFT JOIN `bigquery-public-data.sec_quarterly_financials.rendering` AS render
ON fin.submission_number = render.submission_number
WHERE 
    fin.company_name LIKE '%NETFLIX%'
AND fin.form = '10-K'
AND render.shortname LIKE '%INCOME%'
GROUP BY 1,2,3, 4,5

--Draft 2 better
SELECT 
  fin.company_name, 
  fin.measure_tag, 
  fin.value, 
  fin.submission_number, 
  report.preferred_label, 
  fin.period_end_date
FROM `bigquery-public-data.sec_quarterly_financials.quick_summary` AS fin
LEFT JOIN `bigquery-public-data.sec_quarterly_financials.presentation` AS report
ON fin.measure_tag = report.measure_tag
WHERE 
    fin.company_name LIKE '%NETFLIX%'
AND fin.form = '10-K'
AND fin.fiscal_year = 2018
AND report.statement = 'IS'
AND report.presented_parenthetically IS TRUE
AND fin.fiscal_year_end = RIGHT(fin.period_end_date,4)
AND fin.fiscal_year = CAST(LEFT(fin.period_end_date,4) AS int64)
GROUP BY 1,2,3, 4,5,6
ORDER BY 2

--Draft 3
SELECT 
  fin.company_name, 
  fin.measure_tag, 
  fin.value, 
  fin.submission_number, 
  fin.period_end_date,
FROM `bigquery-public-data.sec_quarterly_financials.quick_summary` AS fin
LEFT JOIN `bigquery-public-data.sec_quarterly_financials.presentation` AS report
ON fin.measure_tag = report.measure_tag
WHERE 
    fin.company_name LIKE '%NETFLIX%'
AND fin.form = '10-K'
AND fin.fiscal_year = 2018
AND report.presented_parenthetically IS TRUE
AND report.statement = 'IS'
AND fin.fiscal_year_end = RIGHT(fin.period_end_date,4)
AND fin.fiscal_year = CAST(LEFT(fin.period_end_date,4) AS int64)
GROUP BY 1,2,3, 4,5
ORDER BY 2
